1. Extract the middle 3 characters from the string 'ABCDEFG'.

    select SUBSTRING('ABCDEFG',3,3)



2. From a table 'Employees' with a column 'FullName', write a query to extract the first name (assuming it's always the first word before a space).

        select SUBSTRING(FullName,1,charindex(' ',fullname+' ')) as firstname from emp 




3. Extract the first 5 characters from the string 'SQL Server 2022'.

    select SUBSTRING(replace('SQL Server 2022',' ',''),1,5)



4. From a 'Products' table with a 'ProductCode' column, write a query to get the first 3 characters of each product code.

    select SUBSTRING(productcode,1,3) from Products



5. Extract the last 4 characters from the string 'ABCDEFGHIJKL'.

    select right('ABCDEFGHIJKL,4) from Products


6. From an 'Orders' table with an 'OrderID' column (format: ORD-YYYY-NNNN), write a query to extract just the numeric portion at the end.


    select right(orderid,4) as last_4_digs from Products


7. Write a query to find the length of the string 'SQL Server Functions'.


    select len('SQL Server Functions') as len_of_query


8. From a 'Customers' table, find customers whose names are longer than 20 characters.

    select firstname from customers where len(Name)>20


9. Compare the results of character count and byte count for the string 'SQL Server' with a trailing space.

select datalength('hello ')
    datalength returns the bytes required to store the value
    outputs-6

select len('hello ')

    returns the string length
    outputs-5


10. Write a query to find the byte count of an empty string and explain the result.

    select DATALENGTH('')
        to store an empty string no space is required hence the output is 0



11. Find the position of 'Server' in the string 'Microsoft SQL Server'.

    select CHARINDEX('server','microsoft sql server')




12. From an 'Emails' table, write a query to extract the domain name from email addresses.

        select substring(email,CHARINDEX('@',email),len(email)) from email



13. Find the position of the first number in the string 'ABC123DEF456'.

    SELECT patindex('%[0-9]%','ABC123DEF456')



14. Write a query to find all product names from a 'Products' table that contain a number.

    select productname from products where PATINDEX('%[0-9]%',productname)>0



15. Join the strings 'SQL', 'Server', and '2022' with spaces between them.

    select concat('SQL',' ','server',' ',2002)




16. From 'Employees' table with 'FirstName' and 'LastName' columns, create a 'FullName' column.


    select concat(firstname,' ',lastname) as fullname from emp 


17. Join the array ('SQL', 'Server', '2022') with a hyphen as the separator.

    select concat('SQL','-','server','-',2002)


18. From an 'Addresses' table, combine 'Street', 'City', 'State', and 'ZIP' columns into a single address string.

        select concat(Street,' ',City,' ',state,' ',zip,) as address from emp 



19. Change all occurrences of 'a' to 'e' in the string 'database management'.

    select(replace('database managment','a','e'))




20. From a 'Products' table, write a query to replace all spaces in product names with underscores.

    select(replace(productname,' ','_')) from product



21. Create a string of 10 asterisks (*)

    select replicate('*',10)


22. Write a query to pad all product codes in a 'Products' table to a length of 10 characters with leading zeros.

    select right(REPLICATE('0', 10) + 1233, 10) as paddedcode



23. Insert the string 'New ' at the beginning of 'York City'.

    select concat('new',' ','York city')

    


24. From an 'Emails' table, mask the username part of email addresses, showing only the first and last characters.

    select substring(email,1,1)+replicate('*',CHARINDEX('@',email)-3)+SUBSTRING(email,CHARINDEX('@',email)-1,len(email)) from emp


25. Convert the string 'sql server' to uppercase.

    select UPPER('sql server')



26. Write a query to convert all customer names in a 'Customers' table to uppercase.

    update Customers set firstname = UPPER(firstname) 



27. Convert the string 'SQL SERVER' to lowercase.

        select lower('SQL SERVER')


28. From a 'Products' table, write a query to convert all product descriptions to lowercase.

    update products set descriptions=lower(descriptions)


29. Remove trailing spaces from the string 'SQL Server    '.

    select rtrim('SQL Server    ',' ')


30. Write a query to remove trailing spaces from all email addresses in an 'Employees' table.

    select rtrim(email,' ') from emp


31. Remove leading spaces from the string '   SQL Server'.

    select ltrim('     SQL Server',' ')


32. From a 'Comments' table, write a query to remove leading spaces from all comment texts.

        select ltrim(comment,' ') from Comments



33. Display the current date in the format 'dd-MM-yyyy'.


    select format(GETDATE(),'yyyy-MM-dd') as currenttime


34. From an 'Orders' table with an 'OrderTotal' column, display the total as a currency with 2 decimal places.

    select cast(OrderTotal AS DECIMAL(10, 2)) AS formatted_order_total from orders



35. Separate the string 'apple,banana,cherry' into individual fruits.

    select value from string_split('apple,banana,cherry',',') 



36. From a 'Skills' table with a 'SkillList' column containing comma-separated skills, write a query to create a row for each individual skill.

    select value as skills from skills cross apply string_split(SkillList,',')



37. Write a query to display the current date and time.

    	select format(getdate(),'yyyy-MM-dd HH-mm-ss')



38. From an 'Orders' table, find all orders placed in the last 24 hours.

    SELECT * from totalsales where datediff(day,saledate,getdate())<=1



39. Display the current UTC date and time.

    SELECT GETUTCDATE()



40. Write a query to show the time difference between local time and UTC time.

    SELECT datediff(hour,sysutcdatetime(),sysdatetime()) as hour_diff,datediff(minute,sysutcdatetime(),sysdatetime()) as minute_diff,datediff(second,sysutcdatetime(),sysdatetime()) as second_diff



41. Convert the current date and time to 'Pacific Standard Time'.

    select SYSDATETIMEOFFSET() at time zone 'Pacific Standard Time' AS pacific_time


42. From a 'Flights' table with a 'DepartureTime' column in UTC, convert all departure times to 'Eastern Standard Time'.

    update flights set departuretime= departuretime at time zone 'Eastern Standard Time'



43. Add 3 months to the current date.

    select dateadd(MONTH,3,GETDATE())


44. From an 'Employees' table, write a query to calculate each employee's retirement date (65 years from their 'DateOfBirth').

    select dateadd(year,65,DateOfBirth) from emp



45. Calculate the number of days between '2023-01-01' and '2023-12-31'.

    select datediff(day,'2023-01-01','2023-12-31')


46. From an 'Orders' table, find the average number of days between order date and ship date.



    select avg(datediff(day,saledate,shipdate)) from totalsales


47. Extract the month number from the date '2023-09-15'.

    select month('2023-09-15')

48. From a 'Sales' table, write a query to group total sales by the quarter of the sale date.

    select sum(quantity) as total_sales,datepart(quarter,saledate) as quarter_no from totalsales group by datepart(quarter,saledate)




49. Extract the year from the current date.

    select year(GETDATE())



50. From an 'Employees' table, find all employees hired in the year 2022.


    select firstname from emp where year(HireDate)=2024

51. Check if '2023-02-30' is a valid date.

    if try_convert(date,'2023-02-30') is not null begin print 'date is valid' end
    else begin print 'date is not valid' end



52. Write a query to find all rows in a 'UserInputs' table where the 'EnteredDate' column contains invalid dates.

    select * from UserInputs where TRY_CONVERT(date,EnteredDateDate) is null



53. Find the last day of the current month.

    select day(EOMONTH(GETDATE())) as last_date


54. From a 'Subscriptions' table, write a query to extend all subscription end dates to the end of their respective months.

    update subscription set subscription_date=EOMONTH(subscription_date)

55. Display the current date and time.

    select getdate() as current_date_time

56. Compare the results of two different methods to get the current timestamp - are they always the same?

    getdate()-gives the date and time with lower precision
    sysdatetime()-gives the date and time with higher precision

57. Get the current date and time with higher precision than standard methods.

    
    select SYSDATETIME()

58. Write a query to insert the current high-precision timestamp into a 'Logs' table.

    insert into Logs (LogTime) values (SYSDATETIME())


59. Display the current UTC date and time with high precision.

    select SYSDATETIMEOFFSET()

60. Calculate the difference in microseconds between the current local time and UTC time.

    select DATEDIFF(microsecond,sysdatetime(),sysdatetimeoffset()) as diff_in_microsec

61. Get the current date, time, and time zone offset.

        select SYSDATETIMEOFFSET()


62. From a 'GlobalEvents' table, convert all event times to include time zone offset information.

    alter table GlobalEvents alter column event_time datetimeoffset

63. Extract the month number from the date '2023-12-25'.

    select month('2023-12-25') as month_number

64. From a 'Sales' table, find the total sales for each month of the previous year.

    select datename(month,SaleDate) as month_of_sales,sum(quantity) as total_quantity from totalsales where year(saledate)=year(GETDATE())-1 group by month(SaleDate),datename(month,saledate)


65. Extract the day of the month from '2023-03-15'.

    select day('2023-03-15') as day_of_the_month

66. Write a query to find all orders from an 'Orders' table that were placed on the 15th day of any month.

    select orders from Orders where day(order_placed_day)=15


67. Get the name of the month for the date '2023-09-01'.

    select DATENAME(month,'2023-09-01')

68. From an 'Events' table, write a query to display the day of the week (in words) for each event date.

    select datename(weekday,eventdate)from events



69. Create a date for Christmas Day 2023.

    select cast('2024-12-25' as date) as christmas



70. Write a query to convert separate year, month, and day columns from a 'Dates' table into a single DATE column.


    select concat(year,'-',month,'-',day) as Combined_date from dates